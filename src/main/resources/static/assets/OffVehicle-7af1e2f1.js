import{u as M,r as a,a as C,j as e,c as H,B as S,_ as h}from"./index-2e85eed9.js";import{l as U,C as q}from"./CMSPagination-8551283f.js";import{F as z}from"./index.es-55149f84.js";import{u as G}from"./index-fb770e0d.js";import{T as J}from"./index-9c37b3d3.js";const Q=e.jsx(z,{icon:G,style:{color:"#fff"}}),W=({searchTerm:d})=>{M();const i=a.useRef(null),[m,k]=a.useState(!0),[n,_]=a.useState([]),f=a.useRef(null),[X,V]=a.useState(!1),[Y,L]=a.useState(!1),[g,p]=a.useState([]),[x,Z]=a.useState([]),[c,T]=a.useState(),[o,A]=a.useState("asc"),[b,P]=a.useState(1),u=10;sessionStorage.getItem("branch"),sessionStorage.getItem("role");const y=sessionStorage.getItem("userid");a.useEffect(()=>{const t=`${S}/api/vehicleType`;C({method:"post",url:`${t}`,data:{user:y,type:"off"}}).then(s=>{_(s.data),p(s.data),k(!1)}).catch(s=>console.log(s))},[]),a.useEffect(()=>{const t=n.filter(s=>{const r=d.toLowerCase();return s.reg_number.toLowerCase().includes(r)||s.driver.toLowerCase().includes(r)||s.branch.toLowerCase().includes(r)||s.from_date.toLowerCase().includes(r)||s.to_date.toLowerCase().includes(r)||s.driver_notes.toLowerCase().includes(r)||s.notes.toLowerCase().includes(r)||s.status.toLowerCase().includes(r)});p(t)},[d]),a.useLayoutEffect(()=>{const t=x.length>0&&x.length<n.length;V(x.length===n.length),L(t),f.current&&(f.current.indeterminate=t)},[x,n.length]);function I(t){window.confirm("Are you sure you wish to restore this item?")?w(parseInt(t,10)):w(0)}function w(t){t>0&&C({method:"post",url:`${S}/api/vehicleType`,data:{user:y,record:t,type:"restore"}}).then(s=>{s.data[0].msg1=="Vehicle restore successfully"&&h.success("Vehicle restore successfully"),s.data[0].msg1=="Vehicle recovery failed"&&h.error("Vehicle recovery failed"),s.data[0].msg2=="Vehicle Assignment restore successfully"&&h.success("Vehicle Assignment restore successfully"),s.data[0].msg2=="Vehicle Assignment recovery failed"&&h.error("Vehicle Assignment recovery failed"),window.location.reload()}).catch(s=>console.log(s))}const E=t=>{P(t)},D=(t,s,r)=>t.sort(($,K)=>{const N=$[s],v=K[s];return N<v?r==="asc"?-1:1:N>v?r==="asc"?1:-1:0}),l=t=>{const s=c===t&&o==="asc"?"desc":"asc";T(t),A(s);const r=D([...n],t,o);p(r)},j=b*u,O=j-u,R=g.slice(O,j),F=Math.ceil(g.length/u),B=n.length;return e.jsx(e.Fragment,{children:m?e.jsx(H,{}):e.jsxs("div",{className:"flex-1 flex justify-between flex-col rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1 min-w-[900px]",children:[e.jsxs("div",{className:"relative overflow-x-scroll",children:[e.jsx(U.DownloadTableExcel,{filename:"Telephone Report",sheet:"vehicles",currentTableRef:i.current,children:e.jsx("button",{className:"bg-blue-500 font-bold py-2 px-4 rounded hover:bg-blue-700 transition duration-300",children:"Export Excel"})}),e.jsxs("table",{ref:i,className:"min-w-full table-fixed divide-y divide-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-2 text-left dark:bg-meta-4 border-[#aaaaaa] border-b border-t",children:[e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>l("reg_number"),children:["Vehicle Number ",c==="reg_number"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>l("driver"),children:["Driver ",c==="driver"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>l("branch"),children:["Branch ",c==="branch"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>l("from_date"),children:["From Date ",c==="from_date"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>l("to_date"),children:["To Date ",c==="to_date"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>l("driver_notes"),children:["Vehicle Notes ",c==="driver_notes"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>l("notes"),children:["Notes ",c==="notes"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>l("status"),children:["Assignment Status ",c==="status"?o==="asc"?"↑":"↓":""]}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:R.map((t,s)=>e.jsxs("tr",{className:`${s%2===1?"bg-gray-2 dark:bg-meta-4":"dark:bg-boxdark"} hover:cursor-pointer border-b border-[#aaaaaa]`,children:[e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.reg_number}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.driver}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.branch}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.from_date}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.to_date}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.driver_notes}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.notes}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.status}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.jsxs("a",{id:t.id,onClick:()=>I(t.id),className:"",style:{background:"blue",color:"#fff"},children:["restore",Q]})})]},s))})]})]}),e.jsx(q,{currentPage:b,totalPages:F,totalNumbers:B,perNumberPage:10,onPageChange:E})]})})},oe=()=>{const d=[],[i,m]=a.useState("");return e.jsxs("div",{className:"w-full h-full flex flex-col gap-4 ",children:[e.jsx(J,{title:"",btns:d,searchTerm:i,setSearchTerm:m}),e.jsx(W,{searchTerm:i})]})};export{oe as default};
