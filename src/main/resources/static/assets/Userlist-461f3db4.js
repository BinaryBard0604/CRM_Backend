import{r,a as S,j as e,c as K,L as M,B as k}from"./index-2e85eed9.js";import{F as C}from"./index.es-55149f84.js";import{m as V,n as q}from"./index-fb770e0d.js";import{l as z,C as G}from"./CMSPagination-8551283f.js";import{T as J}from"./index-9c37b3d3.js";const Q=e.jsx(C,{icon:V,style:{color:""}}),W=e.jsx(C,{icon:q,style:{color:""}}),X=({searchTerm:i})=>{const c=r.useRef(null);r.useEffect(()=>{L()},[]);const[u,v]=r.useState(!0),[o,P]=r.useState([]),L=async()=>{const t=`${k}/api/userlist`,a={type:"userlist",user:"user"};await S.post(t,a).then(s=>{P(s.data.list),m(s.data.list),v(!1)}).catch(s=>{console.log(s)})},b=r.useRef(null),[Y,T]=r.useState(!1),[Z,E]=r.useState(!1),[f,m]=r.useState([]),[d,ee]=r.useState([]),[x,A]=r.useState(),[l,I]=r.useState("asc"),[g,_]=r.useState(1),h=10;r.useEffect(()=>{const t=o.filter(a=>{const s=i.toLowerCase();return a.user.toLowerCase().includes(s)||a.username.toLowerCase().includes(s)||a.branch_name.toLowerCase().includes(s)});m(t)},[i]),r.useLayoutEffect(()=>{const t=d.length>0&&d.length<o.length;T(d.length===o.length),E(t),b.current&&(b.current.indeterminate=t)},[d,o.length]);const D=t=>{_(t)};function O(t){window.confirm("Are you sure to delete this user!")?y(parseInt(t,10)):y(0)}const y=async t=>{if(t>0){const a=`${k}/api/deleteuser`,s={type:"deleteuser",deleteuserid:t.toString()};await S.post(a,s).then(n=>{n.data.status=="1",alert(n.data.message),window.location.reload()}).catch(n=>{console.log(n)})}},R=(t,a,s)=>t.sort((n,H)=>{const j=n[a],N=H[a];return j<N?s==="asc"?-1:1:j>N?s==="asc"?1:-1:0}),p=t=>{const a=x===t&&l==="asc"?"desc":"asc";A(t),I(a);const s=R([...o],t,l);m(s)},w=g*h,U=w-h,B=f.slice(U,w),F=Math.ceil(f.length/h),$=o.length;return e.jsx(e.Fragment,{children:u?e.jsx(K,{}):e.jsxs("div",{className:"flex-1 flex justify-between flex-col rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1 min-w-[900px]",children:[e.jsxs("div",{className:"relative overflow-x-scroll",children:[e.jsx(z.DownloadTableExcel,{filename:"User List",sheet:"vehicles",currentTableRef:c.current,children:e.jsx("button",{className:"bg-blue-500 font-bold py-2 px-4 rounded hover:bg-blue-700 transition duration-300",children:"Export Excel"})}),e.jsxs("table",{ref:c,className:"min-w-full table-fixed divide-y divide-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-2 text-left dark:bg-meta-4 border-[#aaaaaa] border-b border-t",children:[e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>p("user"),children:["Name ",x==="user"?l==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>p("username"),children:["Username ",x==="username"?l==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>p("branch_name"),children:["Branch ",x==="branch_name"?l==="asc"?"↑":"↓":""]}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:B.map((t,a)=>e.jsxs("tr",{className:`${a%2===1?"bg-gray-2 dark:bg-meta-4":"dark:bg-boxdark"} hover:cursor-pointer border-b border-[#aaaaaa]`,children:[e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.user}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.username}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.branch_name}),e.jsxs("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:[e.jsx(M,{to:`/users/user-edit/${t.id}`,children:e.jsx("button",{className:"btn btn-primary",style:{padding:"6px 12px"},children:W})}),e.jsx("a",{className:"btn btn-danger",onClick:s=>O(t.id),style:{padding:"6px 12px"},children:Q})]})]},a))})]})]}),e.jsx(G,{currentPage:g,totalPages:F,totalNumbers:$,perNumberPage:10,onPageChange:D})]})})},oe=()=>{const i=[{label:"New",path:"/users/add-user"}],[c,u]=r.useState("");return e.jsxs("div",{className:"w-full h-full flex flex-col gap-4 ",children:[e.jsx(J,{title:"",btns:i,searchTerm:c,setSearchTerm:u}),e.jsx(X,{searchTerm:c})]})};export{oe as default};
