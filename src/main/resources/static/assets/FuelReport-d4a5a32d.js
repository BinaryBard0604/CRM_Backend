import{u as U,r,a as B,j as e,c as K,B as Y}from"./index-2e85eed9.js";import{l as W,C as q}from"./CMSPagination-8551283f.js";import{T as z}from"./TopSearchBarWithDate-08a60a23.js";const G=({searchTerm:m,startDate:o,endDate:d})=>{U();const p=r.useRef(null),u=sessionStorage.getItem("branch"),b=sessionStorage.getItem("role"),[h,x]=r.useState(!1);sessionStorage.getItem("userid");const[n,f]=r.useState([]),j=r.useRef(null),[H,k]=r.useState(!1),[J,v]=r.useState(!1),[N,y]=r.useState([]),[g,Q]=r.useState([]),[l,L]=r.useState(),[c,T]=r.useState("asc"),[S,A]=r.useState(1),w=10,_=`${Y}/api/fuelReport`;r.useEffect(()=>{const t=new Date(o),s=new Date(d);o!=""&&d!=""&&t<s&&o.split("-")[0]==d.split("-")[0]&&parseInt(o.split("-")[0],10)>2020&&(x(!0),B({method:"post",url:_,data:{branch:u,user_role:b,start:o,end:d,status:1,type:"report"}}).then(a=>{f(a.data),y(a.data),x(!1),x(!1)}).catch(a=>console.log(a.message)))},[o,d]),r.useEffect(()=>{const t=n.filter(s=>{const a=m.toLowerCase();return s.Vendor.toLowerCase().includes(a)||s.VehiclePlateNumber.toLowerCase().includes(a)||s.driver_name.toLowerCase().includes(a)||s.branch.toLowerCase().includes(a)||s.Volume.toLowerCase().includes(a)||s.UnitPrice.toLowerCase().includes(a)||s.VatAmount.toLowerCase().includes(a)||s.TotalAmount.toLowerCase().includes(a)||s.total_usage.toLowerCase().includes(a)});y(t)},[m]),r.useLayoutEffect(()=>{const t=g.length>0&&g.length<n.length;k(g.length===n.length),v(t),j.current&&(j.current.indeterminate=t)},[g,n.length]);const E=t=>{A(t)},R=(t,s,a)=>t.sort((M,O)=>{const V=M[s],P=O[s];return V<P?a==="asc"?-1:1:V>P?a==="asc"?1:-1:0}),i=t=>{const s=l===t&&c==="asc"?"desc":"asc";L(t),T(s);const a=R([...n],t,c);y(a)},C=S*w,I=C-w,D=N.slice(I,C),F=Math.ceil(N.length/w),$=n.length;return e.jsx(e.Fragment,{children:h?e.jsx(K,{}):e.jsxs("div",{className:"flex-1 flex justify-between flex-col rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1 min-w-[900px]",children:[e.jsxs("div",{className:"relative overflow-x-scroll",children:[e.jsx(W.DownloadTableExcel,{filename:"Fuel Report",sheet:"vehicles",currentTableRef:p.current,children:e.jsx("button",{className:"bg-blue-500 font-bold py-2 px-4 rounded hover:bg-blue-700 transition duration-300",children:"Export Excel"})}),e.jsxs("table",{ref:p,className:"min-w-full table-fixed divide-y divide-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-2 text-left dark:bg-meta-4 border-[#aaaaaa] border-b border-t",children:[e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("Vendor"),children:["Vendor ",l==="Vendor"?c==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("VehiclePlateNumber"),children:["Vehicle No. ",l==="VehiclePlateNumber"?c==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("driver_name"),children:["Driver ",l==="driver_name"?c==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("branch"),children:["Branch ",l==="branch"?c==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("Volume"),children:["Volume ",l==="Volume"?c==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("UnitPrice"),children:["Unit Price ",l==="UnitPrice"?c==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("VatAmount"),children:["VAT Amount ",l==="VatAmount"?c==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("TotalAmount"),children:["Price ",l==="TotalAmount"?c==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("total_usage"),children:["Total Price ",l==="total_usage"?c==="asc"?"↑":"↓":""]})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:D.map((t,s)=>e.jsxs("tr",{className:`${s%2===1?"bg-gray-2 dark:bg-meta-4":"dark:bg-boxdark"} hover:cursor-pointer border-b border-[#aaaaaa]`,children:[e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.Vendor}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.VehiclePlateNumber}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.driver_name}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.branch}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.Volume}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.UnitPrice}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.VatAmount}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.TotalAmount}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.total_usage})]},s))})]})]}),e.jsx(q,{currentPage:S,totalPages:F,totalNumbers:$,perNumberPage:10,onPageChange:E})]})})},te=()=>{const m=[],o=new Date;o.getMonth();const d=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`,p=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-01`,[u,b]=r.useState(""),[h,x]=r.useState(p),[n,f]=r.useState(d);return e.jsxs("div",{className:"w-full h-full flex flex-col gap-4 ",children:[e.jsx(z,{title:"",btns:m,startDate:h,endDate:n,setStartDate:x,setEndDate:f,searchTerm:u,setSearchTerm:b}),e.jsx(G,{searchTerm:u,startDate:h,endDate:n})]})};export{te as default};
