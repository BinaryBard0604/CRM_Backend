import{u as I,r as d,a as m,j as e,B as u,_ as x}from"./index-2e85eed9.js";import{S as v}from"./react-select.esm-3abbb7bc.js";import{I as B,a as F,E as $}from"./index-497b2833.js";const R=()=>{const w=I(),[N,p]=d.useState(!1),f=sessionStorage.getItem("userid"),h=window.location.href.split("/").pop()||"",[s,c]=d.useState({name:"",username:"",password:"",password1:"",email:"",phone:"",branch:[]}),[O,k]=d.useState(void 0),[T,S]=d.useState(void 0),[y,b]=d.useState(void 0),[g,C]=d.useState(void 0);d.useEffect(()=>{E(h),P(),_(h)},[]);const E=async(t="")=>{const o=`${u}/api/edituser`,r={type:"edituser",user_id:t.toString()};try{const a=(await m.post(o,r)).data,i=a.branch.split(",");c({...s,name:a.user,username:a.username,password:"******",password1:a.password,email:a.email,phone:a.phone,branch:i})}catch(l){console.log(l)}},P=async()=>{var r;const t=`${u}/api/branch-list`,o={type:"branch-list",user:f};try{const l=await m.post(t,o);k(l.data);const a=(r=l.data)==null?void 0:r.map(i=>({label:`${i.branch}`,value:`${i.id}`}));C(a)}catch(l){console.log(l)}},_=async(t="")=>{var l;const o=`${u}/api/selectedBranch`,r={type:"selected-branch",user_id:t.toString(),user:f};try{const a=await m.post(o,r);S(a.data);const i=(l=a.data)==null?void 0:l.map(n=>({label:`${n.branch}`,value:`${n.id}`}));b(i)}catch(a){console.log(a)}},j=t=>{c({...s,branch:Array.isArray(t)?t.map(o=>o.value):[]}),b(t)},A=async()=>{const t=`${u}/api/updateuser`;let o=0,r=s.email.lastIndexOf("@"),l=s.email.lastIndexOf("."),a=!1;if(Object.entries(s).forEach(([i,n])=>{n===""&&(o++,a=!0)}),a&&x.error("Please enter all the required fields!"),!(r<l&&r>0&&s.email.indexOf("@@")===-1&&l>2&&s.email.length-l>2)){x.error("Please enter a valid email id"),o++;return}if(!(o>0)){const i={type:"updateuser",name:s.name,username:s.username,password:s.password,password1:s.password1,email:s.email,phone:s.phone,branch:s.branch.join(","),user_id:h,user:f};try{p(!0);const n=await m.post(t,i);n.data.status==="1"?(x.success(n.data.message),setTimeout(()=>{w("/users/user-list")},2e3),p(!1)):(x.error(n.data.message),p(!1))}catch(n){console.log(n)}}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-4 flex-1 h-full",children:[e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("div",{className:"flex flex-row gap-6 items-center",children:e.jsxs("div",{className:"flex flex-row text-center items-center gap-2 font-bold",children:["Edit User",e.jsx(B,{})]})}),e.jsx("div",{className:"flex flex-row items-center",children:e.jsx(F,{})})]}),e.jsxs("div",{className:"rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1 flex-1",children:[e.jsx("div",{className:"flex gap-2 mb-5",children:e.jsx("button",{type:"button",onClick:A,className:"flex items-center justify-center block px-5 rounded border border-primary bg-primary p-2 text-center font-medium text-white transition hover:bg-opacity-90",children:N?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border-4 border-transparent border-t-white animate-spin rounded-full"}),e.jsx("span",{className:"ml-2",children:"Saving..."})," "]}):e.jsx("p",{children:"Save"})})}),e.jsxs("div",{className:"flex flex-row gap-5 items-center h-10 mb-5",children:[e.jsx($,{}),e.jsx("h1",{className:"text-3xl font-semibold",children:"Edit User"})]}),e.jsx("div",{className:"flex md:flex-row gap-5 flex-col",children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6 w-full",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"first-name",className:"block text-sm/6 font-medium text-gray-900",children:["Name ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{id:"first-name",name:"name",value:s.name,onChange:t=>c({...s,name:t.target.value}),autoComplete:"given-name",className:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"last-name",className:"block text-sm/6 font-medium text-gray-900",children:["Username ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{id:"last-name",name:"username",value:s.username,onChange:t=>c({...s,username:t.target.value}),type:"text",autoComplete:"family-name",className:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"last-name",className:"block text-sm/6 font-medium text-gray-900",children:["Password ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{id:"last-name",name:"password",value:s.password,onChange:t=>c({...s,password:t.target.value}),type:"text",autoComplete:"family-name",className:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{id:"last-name",name:"password1",value:s.password1,onChange:t=>c({...s,password1:t.target.value}),type:"text",autoComplete:"family-name",className:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"last-name",className:"block text-sm/6 font-medium text-gray-900",children:["Email ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{id:"last-name",name:"email",value:s.email,onChange:t=>c({...s,email:t.target.value}),type:"text",autoComplete:"family-name",className:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{htmlFor:"last-name",className:"block text-sm/6 font-medium text-gray-900",children:["Phone ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{id:"last-name",name:"phone",value:s.phone,onChange:t=>c({...s,phone:t.target.value}),type:"text",autoComplete:"family-name",className:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"})})]})]})}),e.jsxs("label",{htmlFor:"last-name",className:"mt-5 block text-sm/6 font-medium text-gray-900",children:["Branch ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("div",{className:"mt-2",children:y&&g?e.jsx(e.Fragment,{children:e.jsx(v,{isMulti:!0,onChange:j,value:y,options:g})}):e.jsx(v,{isMulti:!0,onChange:j,options:g})})]})]})})};export{R as default};
