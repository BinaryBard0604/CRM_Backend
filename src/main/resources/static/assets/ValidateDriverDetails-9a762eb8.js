import{u as $,r as a,a as M,j as e,c as K,B as q}from"./index-2e85eed9.js";import{l as H,C as U}from"./CMSPagination-8551283f.js";import{F as z}from"./index.es-55149f84.js";import{n as G}from"./index-fb770e0d.js";import{T as J}from"./index-9c37b3d3.js";const Q=e.jsx(z,{icon:G,style:{color:"blue"}}),W=({searchTerm:i})=>{const d=$(),x=a.useRef(null),[w,N]=a.useState(!0),[l,v]=a.useState([]),u=a.useRef(null),[X,S]=a.useState(!1),[Y,_]=a.useState(!1),[f,h]=a.useState([]),[p,Z]=a.useState([]),[n,C]=a.useState(),[o,k]=a.useState("asc"),[b,D]=a.useState(1),m=10,L=sessionStorage.getItem("branch"),P=sessionStorage.getItem("role");sessionStorage.getItem("userid"),a.useEffect(()=>{const t=`${q}/api/getDrivers`;M({method:"post",url:`${t}`,data:{branch:L,user_role:P,status:3,type:"normal"}}).then(s=>{v(s.data),h(s.data),N(!1)}).catch(s=>console.log(s))},[]),a.useEffect(()=>{const t=l.filter(s=>{const r=i.toLowerCase();return s.full_name.toLowerCase().includes(r)||s.branch.toLowerCase().includes(r)||s.phone.toLowerCase().includes(r)||s.license_expiry_date.toLowerCase().includes(r)||s.date_employed.toLowerCase().includes(r)});h(t)},[i]),a.useLayoutEffect(()=>{const t=p.length>0&&p.length<l.length;S(p.length===l.length),_(t),u.current&&(u.current.indeterminate=t)},[p,l.length]);const T=t=>{D(t)};function E(t){d(`/drivers/edit-driver/${t}`)}const I=(t,s,r)=>t.sort((V,B)=>{const y=V[s],j=B[s];return y<j?r==="asc"?-1:1:y>j?r==="asc"?1:-1:0}),c=t=>{const s=n===t&&o==="asc"?"desc":"asc";C(t),k(s);const r=I([...l],t,o);h(r)},g=b*m,R=g-m,O=f.slice(R,g),A=Math.ceil(f.length/m),F=l.length;return e.jsx(e.Fragment,{children:w?e.jsx(K,{}):e.jsxs("div",{className:"flex-1 flex justify-between flex-col rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1 min-w-[900px]",children:[e.jsxs("div",{className:"relative overflow-x-scroll",children:[e.jsx(H.DownloadTableExcel,{filename:"Telephone Report",sheet:"vehicles",currentTableRef:x.current,children:e.jsx("button",{className:"bg-blue-500 font-bold py-2 px-4 rounded hover:bg-blue-700 transition duration-300",children:"Export Excel"})}),e.jsxs("table",{ref:x,className:"min-w-full table-fixed divide-y divide-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-2 text-left dark:bg-meta-4 border-[#aaaaaa] border-b border-t",children:[e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>c("full_name"),children:["Full Name ",n==="full_name"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>c("branch"),children:["Branch ",n==="branch"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>c("phone"),children:["Mobile ",n==="phone"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>c("license_expiry_date"),children:["Valid Drivers License ",n==="license_expiry_date"?o==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>c("date_employed"),children:["Date Employed ",n==="date_employed"?o==="asc"?"↑":"↓":""]}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:O.map((t,s)=>e.jsxs("tr",{className:`${s%2===1?"bg-gray-2 dark:bg-meta-4":"dark:bg-boxdark"} hover:cursor-pointer border-b border-[#aaaaaa]`,children:[e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.full_name}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.branch}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.phone}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.license_expiry_date}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.date_employed}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.jsx("a",{title:"Edit Driver",id:t.id,onClick:()=>E(t.id),className:"",children:Q})})]},s))})]})]}),e.jsx(U,{currentPage:b,totalPages:A,totalNumbers:F,perNumberPage:10,onPageChange:T})]})})},oe=()=>{const i=[{label:"New",path:"/drivers/add-driver"}],[d,x]=a.useState("");return e.jsxs("div",{className:"w-full h-full flex flex-col gap-4 ",children:[e.jsx(J,{title:"",btns:i,searchTerm:d,setSearchTerm:x}),e.jsx(W,{searchTerm:d})]})};export{oe as default};
