import{u as U,r as s,a as S,B as N,j as t,c as z}from"./index-2e85eed9.js";import{l as G,C as H}from"./CMSPagination-8551283f.js";import{F as k}from"./index.es-55149f84.js";import{m as J,n as Q}from"./index-fb770e0d.js";import{T as W}from"./index-9c37b3d3.js";const X=t.jsx(k,{icon:J,style:{color:"red"}}),Y=t.jsx(k,{icon:Q,style:{color:"blue"}}),Z=({searchTerm:c})=>{const n=U(),i=s.useRef(null),[T,C]=s.useState(!0),[l,_]=s.useState([]),u=s.useRef(null),[ee,L]=s.useState(!1),[te,E]=s.useState(!1),[f,x]=s.useState([]),[d,se]=s.useState([]),[h,P]=s.useState(),[r,I]=s.useState("asc"),[g,D]=s.useState(1),p=10;sessionStorage.getItem("branch"),sessionStorage.getItem("role");const b=sessionStorage.getItem("userid");s.useEffect(()=>{S({method:"post",url:`${N}/api/vehicleType`,data:{user:b,type:"list"}}).then(e=>{_(e.data),x(e.data),C(!1)}).catch(e=>console.log(e))},[]),s.useEffect(()=>{const e=l.filter(a=>{const o=c.toLowerCase();return a.vehicle_type.toLowerCase().includes(o)||a.month_allowance.toLowerCase().includes(o)||a.km_allowance.toLowerCase().includes(o)});x(e)},[c]),s.useLayoutEffect(()=>{const e=d.length>0&&d.length<l.length;L(d.length===l.length),E(e),u.current&&(u.current.indeterminate=e)},[d,l.length]);const R=e=>{D(e)};function V(e){window.confirm("Are you sure you wish to delete this item?")?y(parseInt(e,10)):y(0)}function y(e){e>0&&S({method:"post",url:`${N}/api/vehicleType`,data:{user:b,record:e,type:"delete"}}).then(a=>{window.location.reload()}).catch(a=>console.log(a))}function A(e){n(`/vehicles/edit-vehicle-type/${e}`)}const O=(e,a,o)=>e.sort((M,q)=>{const j=M[a],v=q[a];return j<v?o==="asc"?-1:1:j>v?o==="asc"?1:-1:0}),m=e=>{const a=h===e&&r==="asc"?"desc":"asc";P(e),I(a);const o=O([...l],e,r);x(o)},w=g*p,F=w-p,$=f.slice(F,w),B=Math.ceil(f.length/p),K=l.length;return t.jsx(t.Fragment,{children:T?t.jsx(z,{}):t.jsxs("div",{className:"flex-1 flex justify-between flex-col rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1 min-w-[900px]",children:[t.jsxs("div",{className:"relative overflow-x-scroll",children:[t.jsx(G.DownloadTableExcel,{filename:"Telephone Report",sheet:"vehicles",currentTableRef:i.current,children:t.jsx("button",{className:"bg-blue-500 font-bold py-2 px-4 rounded hover:bg-blue-700 transition duration-300",children:"Export Excel"})}),t.jsxs("table",{ref:i,className:"min-w-full table-fixed divide-y divide-gray-300",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-2 text-left dark:bg-meta-4 border-[#aaaaaa] border-b border-t",children:[t.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>m("vehicle_type"),children:["Vehicle Type ",h==="vehicle_type"?r==="asc"?"↑":"↓":""]}),t.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>m("month_allowance"),children:["Fuel Allowance ",h==="month_allowance"?r==="asc"?"↑":"↓":""]}),t.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>m("km_allowance"),children:["KM Allowance ",h==="km_allowance"?r==="asc"?"↑":"↓":""]}),t.jsx("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Action"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:$.map((e,a)=>t.jsxs("tr",{className:`${a%2===1?"bg-gray-2 dark:bg-meta-4":"dark:bg-boxdark"} hover:cursor-pointer border-b border-[#aaaaaa]`,children:[t.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.vehicle_type}),t.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.month_allowance}),t.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.km_allowance}),t.jsxs("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:[t.jsx("a",{title:"Delete Vehicle",id:e.id,onClick:()=>V(e.id),className:"",children:X}),"   ",t.jsx("a",{title:"Edit Vehicle Type",id:e.id,onClick:()=>A(e.id),className:"",children:Y})]})]},a))})]})]}),t.jsx(H,{currentPage:g,totalPages:B,totalNumbers:K,perNumberPage:10,onPageChange:R})]})})},ne=()=>{const c=[{label:"New",path:"/vehicles/add-vehicle-type"}],[n,i]=s.useState("");return t.jsxs("div",{className:"w-full h-full flex flex-col gap-4 ",children:[t.jsx(W,{title:"",btns:c,searchTerm:n,setSearchTerm:i}),t.jsx(Z,{searchTerm:n})]})};export{ne as default};
