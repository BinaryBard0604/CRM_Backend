import{u as V,r as s,a as K,j as e,c as $,B as U}from"./index-2e85eed9.js";import{l as W,C as q}from"./CMSPagination-8551283f.js";import{T as z}from"./TopSearchBarWithYearMonth-5600c6ec.js";const G=({searchTerm:h,year:c,month:i})=>{V();const g=s.useRef(null),f=sessionStorage.getItem("branch"),m=sessionStorage.getItem("role"),[j,d]=s.useState(!1);sessionStorage.getItem("userid");const[o,b]=s.useState([]),u=s.useRef(null),[H,_]=s.useState(!1),[J,L]=s.useState(!1),[w,y]=s.useState([]),[p,Q]=s.useState([]),[l,P]=s.useState(),[n,R]=s.useState("asc"),[v,T]=s.useState(1),S=10,D=`${U}/api/otherReport`;s.useEffect(()=>{c!=""&&i!=""&&(d(!0),K({method:"post",url:D,data:{branch:f,user_role:m,year:c,month:i,status:1,type:"salik"}}).then(t=>{b(t.data),y(t.data),d(!1),d(!1)}).catch(t=>console.log(t.message)))},[c,i]),s.useEffect(()=>{const t=o.filter(a=>{const r=h.toLowerCase();return a.vehicle_reg.toLowerCase().includes(r)||a.amount.toLowerCase().includes(r)||a.times.toLowerCase().includes(r)||a.driver_name.toLowerCase().includes(r)||a.driver_id.toLowerCase().includes(r)});y(t)},[h]),s.useLayoutEffect(()=>{const t=p.length>0&&p.length<o.length;_(p.length===o.length),L(t),u.current&&(u.current.indeterminate=t)},[p,o.length]);const E=t=>{T(t)},I=(t,a,r)=>t.sort((B,F)=>{const k=B[a],C=F[a];return k<C?r==="asc"?-1:1:k>C?r==="asc"?1:-1:0}),x=t=>{const a=l===t&&n==="asc"?"desc":"asc";P(t),R(a);const r=I([...o],t,n);y(r)},N=v*S,O=N-S,Y=w.slice(O,N),M=Math.ceil(w.length/S),A=o.length;return e.jsx(e.Fragment,{children:j?e.jsx($,{}):e.jsxs("div",{className:"flex-1 flex justify-between flex-col rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1 min-w-[900px]",children:[e.jsxs("div",{className:"relative overflow-x-scroll",children:[e.jsx(W.DownloadTableExcel,{filename:"Salik Report",sheet:"vehicles",currentTableRef:g.current,children:e.jsx("button",{className:"bg-blue-500 font-bold py-2 px-4 rounded hover:bg-blue-700 transition duration-300",children:"Export Excel"})}),e.jsxs("table",{ref:g,className:"min-w-full table-fixed divide-y divide-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-2 text-left dark:bg-meta-4 border-[#aaaaaa] border-b border-t",children:[e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>x("vehicle_reg"),children:["Vehicle Number ",l==="vehicle_reg"?n==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>x("amount"),children:["Amount ",l==="amount"?n==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>x("times"),children:["No.of Salik ",l==="times"?n==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>x("driver_name"),children:["Drivers ",l==="driver_name"?n==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>x("driver_id"),children:["Driver ID ",l==="driver_id"?n==="asc"?"↑":"↓":""]})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:Y.map((t,a)=>e.jsxs("tr",{className:`${a%2===1?"bg-gray-2 dark:bg-meta-4":"dark:bg-boxdark"} hover:cursor-pointer border-b border-[#aaaaaa]`,children:[e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.vehicle_reg}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.amount}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.times}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.driver_name}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.driver_id})]},a))})]})]}),e.jsx(q,{currentPage:v,totalPages:M,totalNumbers:A,perNumberPage:10,onPageChange:E})]})})},te=()=>{const h=[],[c,i]=s.useState("");let f=new Date().getFullYear();const[m,j]=s.useState(f),[d,o]=s.useState(m.toString()),[b,u]=s.useState("");return e.jsxs("div",{className:"w-full h-full flex flex-col gap-4 ",children:[e.jsx(z,{title:"",btns:h,searchTerm:c,setSearchTerm:i,setYear:o,setMonth:u,thisYear:m}),e.jsx(G,{searchTerm:c,year:d,month:b})]})};export{te as default};
