import{u as K,r,a as V,j as e,c as U,B as Y}from"./index-2e85eed9.js";import{l as W,C as q}from"./CMSPagination-8551283f.js";import{T as z}from"./TopSearchBarWithDate-08a60a23.js";const G=({searchTerm:h,startDate:o,endDate:d})=>{K();const p=r.useRef(null),u=sessionStorage.getItem("branch"),f=sessionStorage.getItem("role"),[m,x]=r.useState(!1);sessionStorage.getItem("userid");const[n,b]=r.useState([]),S=r.useRef(null),[H,_]=r.useState(!1),[J,L]=r.useState(!1),[j,y]=r.useState([]),[g,Q]=r.useState([]),[c,D]=r.useState(),[l,T]=r.useState("asc"),[v,E]=r.useState(1),w=10,I=`${Y}/api/fuelReport`;r.useEffect(()=>{const t=new Date(o),s=new Date(d);o!=""&&d!=""&&t<s&&o.split("-")[0]==d.split("-")[0]&&parseInt(o.split("-")[0],10)>2020&&(x(!0),V({method:"post",url:I,data:{branch:u,user_role:f,start:o,end:d,status:1,type:"driverfuel"}}).then(a=>{b(a.data),y(a.data),x(!1),x(!1)}).catch(a=>console.log(a.message)))},[o,d]),r.useEffect(()=>{const t=n.filter(s=>{const a=h.toLowerCase();return s.id.toLowerCase().includes(a)||s.driver_name.toLowerCase().includes(a)||s.branch.toLowerCase().includes(a)||s.vehicle.toLowerCase().includes(a)||s.km.toLowerCase().includes(a)||s.month_allowance.toLowerCase().includes(a)||s.fuel_total.toLowerCase().includes(a)||s.usage_sts.toLowerCase().includes(a)||s.driverstatus.toLowerCase().includes(a)});y(t)},[h]),r.useLayoutEffect(()=>{const t=g.length>0&&g.length<n.length;_(g.length===n.length),L(t),S.current&&(S.current.indeterminate=t)},[g,n.length]);const P=t=>{E(t)},F=(t,s,a)=>t.sort((B,A)=>{const C=B[s],k=A[s];return C<k?a==="asc"?-1:1:C>k?a==="asc"?1:-1:0}),i=t=>{const s=c===t&&l==="asc"?"desc":"asc";D(t),T(s);const a=F([...n],t,l);y(a)},N=v*w,M=N-w,R=j.slice(M,N),$=Math.ceil(j.length/w),O=n.length;return e.jsx(e.Fragment,{children:m?e.jsx(U,{}):e.jsxs("div",{className:"flex-1 flex justify-between flex-col rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1 min-w-[900px]",children:[e.jsxs("div",{className:"relative overflow-x-scroll",children:[e.jsx(W.DownloadTableExcel,{filename:"Fuel Driver",sheet:"vehicles",currentTableRef:p.current,children:e.jsx("button",{className:"bg-blue-500 font-bold py-2 px-4 rounded hover:bg-blue-700 transition duration-300",children:"Export Excel"})}),e.jsxs("table",{ref:p,className:"min-w-full table-fixed divide-y divide-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-2 text-left dark:bg-meta-4 border-[#aaaaaa] border-b border-t",children:[e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("id"),children:["ID ",c==="id"?l==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("driver_name"),children:["Driver ",c==="driver_name"?l==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("branch"),children:["Branch ",c==="branch"?l==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("vehicle"),children:["Vehicle (From - To : Status) ",c==="vehicle"?l==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("km"),children:["KM. ",c==="km"?l==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("month_allowance"),children:["Monthly Allowance. ",c==="month_allowance"?l==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("fuel_total"),children:["Total fuel Consumption ",c==="fuel_total"?l==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("usage_sts"),children:["Usage Status ",c==="usage_sts"?l==="asc"?"↑":"↓":""]}),e.jsxs("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",onClick:()=>i("driverstatus"),children:["Driver Status ",c==="driverstatus"?l==="asc"?"↑":"↓":""]})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:R.map((t,s)=>e.jsxs("tr",{className:`${s%2===1?"bg-gray-2 dark:bg-meta-4":"dark:bg-boxdark"} hover:cursor-pointer border-b border-[#aaaaaa]`,children:[e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.id}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.driver_name}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.branch}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.vehicle}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.km}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.month_allowance}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.fuel_total}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.usage_sts}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:t.driverstatus})]},s))})]})]}),e.jsx(q,{currentPage:v,totalPages:$,totalNumbers:O,perNumberPage:10,onPageChange:P})]})})},te=()=>{const h=[],o=new Date;o.getMonth();const d=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`,p=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-01`,[u,f]=r.useState(""),[m,x]=r.useState(p),[n,b]=r.useState(d);return e.jsxs("div",{className:"w-full h-full flex flex-col gap-4 ",children:[e.jsx(z,{title:"",btns:h,searchTerm:u,setSearchTerm:f,startDate:m,endDate:n,setStartDate:x,setEndDate:b}),e.jsx(G,{searchTerm:u,startDate:m,endDate:n})]})};export{te as default};
